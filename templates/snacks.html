<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snacks Menu - Restaurant</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;800&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #C9A875;
            --accent-color: #B8956A;
            --text-dark: #e8e8e8;
            --text-light: #a0a0a0;
            --bg-dark: #0f0f0f;
            --bg-card: #1a1a1a;
            --bg-hover: #252525;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a1a 100%);
            min-height: 100vh;
            color: var(--text-dark);
            padding: 30px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* Navigation */
        .nav-bar {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 15px 25px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            border: 1px solid rgba(201, 168, 117, 0.1);
        }

        .nav-btn, .cart-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            cursor: pointer;
            background: var(--bg-hover);
            color: var(--text-dark);
        }

        .nav-btn:hover {
            background: var(--primary-color);
            color: #fff;
            transform: translateY(-2px);
        }

        .cart-btn {
            background: var(--primary-color);
            color: #fff;
        }

        .cart-btn:hover {
            background: var(--accent-color);
        }

        /* Menu Container */
        .menu-container {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid rgba(201, 168, 117, 0.1);
        }

        .menu-container h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--primary-color);
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(201, 168, 117, 0.2);
        }

        .menu-container h2:first-child {
            margin-top: 0;
        }

        /* Menu Item */
        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(201, 168, 117, 0.1);
            transition: background 0.3s ease;
        }

        .menu-item:last-child {
            border-bottom: none;
        }

        .menu-item:hover {
            background: var(--bg-hover);
            border-radius: 10px;
        }

        .menu-details {
            flex: 1;
        }

        .menu-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .menu-price {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .menu-item p {
            color: var(--text-light);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Buttons */
        .add-btn {
            background: var(--primary-color);
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(201, 168, 117, 0.3);
        }

        .add-btn:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(201, 168, 117, 0.1);
            padding: 8px 15px;
            border-radius: 10px;
        }

        .quantity-btn {
            background: var(--primary-color);
            color: white;
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }

        .quantity {
            min-width: 30px;
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text-dark);
        }

        /* Cart Badge */
        .cart-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(201, 168, 117, 0.4);
        }

        .cart-badge.show {
            opacity: 1;
        }

        /* Notification */
        #notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            font-weight: 600;
        }

        #notification.show {
            transform: translateX(0);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .page-header h1 {
                font-size: 2rem;
            }

            .menu-container {
                padding: 20px;
            }

            .menu-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .nav-bar {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Cart Badge -->
    <div class="cart-badge" id="cart-badge">0</div>
    
    <!-- Notification -->
    <div id="notification">Item added to cart!</div>

    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <h1>üçø Snacks Menu</h1>
        </div>

        <!-- Navigation Bar -->
        <div class="nav-bar">
            <a href="/menu" class="nav-btn">‚Üê Back to Menu</a>
            <a href="/cart" class="cart-btn">üõí View Cart</a>
        </div>

        <!-- Menu Container -->
        <div class="menu-container">
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Samosa</div>
                <div class="menu-price">‚Çπ30</div>
                <p>Crispy pastry filled with spiced potatoes and peas</p>  
            </div>
            <div id="button-container-26">
                <button class="add-btn" data-item-id="26" onclick="addToCart(26,'Samosa',30)">ADD</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Kachori</div>
                <div class="menu-price">‚Çπ40</div>
                <p>Flaky, deep-fried snack with a spiced lentil or potato filling</p>  
            </div>
            <div id="button-container-27">
                <button class="add-btn" onclick="addToCart(27,'Kachori',40)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Pani Puri</div>
                <div class="menu-price">‚Çπ35</div>
                <p>Crunchy puris filled with tangy water, potatoes, and chickpeas</p>  
            </div>
            <div id="button-container-28">
                <button class="add-btn" onclick="addToCart(28,'Pani Puri',35)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Veg Puff</div>
                <div class="menu-price">‚Çπ20</div>
                <p>Flaky pastry stuffed with spiced vegetables</p>  
            </div>
            <div id="button-container-29">
                <button class="add-btn" onclick="addToCart(29,'Veg Puff',20)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Egg Puff</div>
                <div class="menu-price">‚Çπ30</div>
                <p>Crispy puff pastry with a seasoned egg filling</p>  
            </div>
            <div id="button-container-30">
                <button class="add-btn" onclick="addToCart(30,'Egg Puff',30)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Cutlet</div>
                <div class="menu-price">‚Çπ35</div>
                <p>Golden-fried potato and veggie patty</p>  
            </div>
            <div id="button-container-31">
                <button class="add-btn" onclick="addToCart(31,'Cutlet',35)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">French Fries</div>
                <div class="menu-price">‚Çπ60</div>
                <p>Classic golden-fried potato sticks</p>  
            </div>
            <div id="button-container-32">
                <button class="add-btn" onclick="addToCart(32,'French Fries',60)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Peri Peri Fries</div>
                <div class="menu-price">‚Çπ85</div>
                <p>Crispy fries tossed in spicy peri peri seasoning</p>  
            </div>
            <div id="button-container-33">
                <button class="add-btn" onclick="addToCart(33,'Peri Peri Fries',85)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Chicken Loaded Fries</div>
                <div class="menu-price">‚Çπ175</div>
                <p>Fries topped with juicy chicken, cheese, and sauces</p>  
            </div>
            <div id="button-container-34">
                <button class="add-btn" onclick="addToCart(34,'Chicken Loaded Fries',175)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Vada Pav</div>
                <div class="menu-price">‚Çπ50</div>
                <p>Spicy potato fritter in a soft bun with chutneys</p>  
            </div>
            <div id="button-container-35">
                <button class="add-btn" onclick="addToCart(35,'Vada Pav',50)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Bhel Puri</div>
                <div class="menu-price">‚Çπ50</div>
                <p>A tangy and crunchy mix of puffed rice, sev, chopped veggies, and chutneys</p>  
            </div>
            <div id="button-container-36">
                <button class="add-btn" onclick="addToCart(36,'Bhel Puri',50)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Veg Sandwich</div>
                <div class="menu-price">‚Çπ75</div>
                <p>Fresh veggies layered with spices and sauces between toasted or grilled bread</p>  
            </div>
            <div id="button-container-37">
                <button class="add-btn" onclick="addToCart(37,'Veg Sandwich',75)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Pav Bhaji</div>
                <div class="menu-price">‚Çπ95</div>
                <p>Spiced mashed vegetables served with buttered pav</p>  
            </div>
            <div id="button-container-38">
                <button class="add-btn" onclick="addToCart(38,'Pav Bhaji',95)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Paneer Roll</div>
                <div class="menu-price">‚Çπ100</div>
                <p>Grilled paneer wrap with veggies and sauces</p>  
            </div>
            <div id="button-container-39">
                <button class="add-btn" onclick="addToCart(39,'Paneer Roll',100)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Sabudana Vada</div>
                <div class="menu-price">‚Çπ65</div>
                <p>Crunchy tapioca fritters with peanuts and spices</p>  
            </div>
            <div id="button-container-40">
                <button class="add-btn" onclick="addToCart(40,'Sabudana Vada',65)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Corn Cheese Balls</div>
                <div class="menu-price">‚Çπ80</div>
                <p>Crispy bites filled with melted cheese and corn</p>  
            </div>
            <div id="button-container-41">
                <button class="add-btn" onclick="addToCart(41,'Corn Cheese Balls',80)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Potato Nuggets</div>
                <div class="menu-price">‚Çπ80</div>
                <p>Golden nuggets made from seasoned potatoes</p>  
            </div>
            <div id="button-container-42">
                <button class="add-btn" onclick="addToCart(42,'Potato Nuggets',80)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Paneer Momos</div>
                <div class="menu-price">‚Çπ120</div>
                <p>Steamed or fried dumplings stuffed with spiced paneer</p>  
            </div>
            <div id="button-container-43">
                <button class="add-btn" onclick="addToCart(43,'Paneer Momos',120)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Cheese Nachos</div>
                <div class="menu-price">‚Çπ110</div>
                <p>Crunchy nachos topped with melted cheese</p>  
            </div>
            <div id="button-container-44">
                <button class="add-btn" onclick="addToCart(44,'Cheese Nachos',110)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Spring Roll</div>
                <div class="menu-price">‚Çπ199</div>
                <p>Crispy fried rolls with a savory veggie filling</p>  
            </div>
            <div id="button-container-45">
                <button class="add-btn" onclick="addToCart(45,'Spring Roll',199)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Chocolate Donut</div>
                <div class="menu-price">‚Çπ55</div>
                <p>Soft donut with rich chocolate glaze</p>  
            </div>
            <div id="button-container-46">
                <button class="add-btn" onclick="addToCart(46,'Chocolate Donut',55)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Brownie with Ice Cream</div>
                <div class="menu-price">‚Çπ140</div>
                <p>Warm brownie served with vanilla ice cream</p>  
            </div>
            <div id="button-container-22">
                <button class="add-btn" onclick="addToCart(22,'Brownie with Ice Cream',140)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Chocolate Tart</div>
                <div class="menu-price">‚Çπ135</div>
                <p>Decadent chocolate-filled tart</p>  
            </div>
            <div id="button-container-23">
                <button class="add-btn" onclick="addToCart(23,'Chocolate Tart',135)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Triple Chocolate Cupcake</div>
                <div class="menu-price">‚Çπ85</div>
                <p>Moist chocolate cupcake with choco chips</p>  
            </div>
            <div id="button-container-24">
                <button class="add-btn" onclick="addToCart(24,'Triple Chocolate Cupcake',85)">Add</button>
            </div>
        </div>
        <div class="menu-item">
            <div class="menu-details">
                <div class="menu-title">Belgian Waffle</div>
                <div class="menu-price">‚Çπ149</div>
                <p>Crispy waffles with syrup, chocolate, or cream</p>  
            </div>
            <div id="button-container-25">
                <button class="add-btn" onclick="addToCart(25,'Belgian Waffle',149)">Add</button>
            </div>
        </div>
        
        <div class="button-group">
            <a href="/menu">
                <button class="back-btn">Back</button>
            </a>
            <a href="/cart">
                <button class="cart-btn">Go to Cart</button>
            </a>
        </div>
    </div>

    <script>
        // Clear localStorage cart if user just logged in/signed up (to prevent cart leakage between accounts)
        (function() {
            var clearLocal = {{ clear_local_cart|default(false)|tojson }};
            if (clearLocal) {
                localStorage.removeItem('cart');
                localStorage.removeItem('cart_user_id');
                console.log('Cart cleared for new user session');
            }
        })();

        // Check if cart belongs to current user - if not, clear it
        (function() {
            var currentUserId = {{ session.get('user_id', 'null') }};
            var cartUserId = localStorage.getItem('cart_user_id');
            
            if (currentUserId && cartUserId && cartUserId !== String(currentUserId)) {
                localStorage.removeItem('cart');
                localStorage.removeItem('cart_user_id');
                console.log('Cart cleared - belongs to different user');
            }
            
            if (currentUserId) {
                localStorage.setItem('cart_user_id', String(currentUserId));
            }
        })();

        // Load cart from localStorage
        let cart = JSON.parse(localStorage.getItem('cart')) || {};

        // Function to add item to cart
        function addToCart(itemId, itemName, itemPrice) {
            // Get existing cart or initialize empty object
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            
            if (!cart[itemId]) {
                cart[itemId] = { name: itemName, price: itemPrice, quantity: 1 };
            } else {
                cart[itemId].quantity++;
            }
            
            // Save to localStorage
            localStorage.setItem('cart', JSON.stringify(cart));
            
            // Update button UI after adding item
            updateButtonUI(itemId, itemName, itemPrice);
            
            // Update cart badge
            updateCartBadge();
            
            // Show notification
            showNotification(itemName);
        }

        // Function to update the button UI
        function updateButtonUI(itemId, itemName, itemPrice) {
            const buttonContainer = document.getElementById(`button-container-${itemId}`);
            
            if (!buttonContainer) {
                console.error(`Button container for item ${itemId} not found!`);
                return;
            }
            
            // Get current cart from localStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            const quantity = cart[itemId]?.quantity || 0;
            
            if (quantity > 0) {
                buttonContainer.innerHTML = `
                    <div class="quantity-selector">
                        <button class="quantity-btn" onclick="decreaseQuantity(${itemId}, '${itemName}', ${itemPrice})">-</button>
                        <span class="quantity" id="quantity-${itemId}">${quantity}</span>
                        <button class="quantity-btn" onclick="increaseQuantity(${itemId}, '${itemName}', ${itemPrice})">+</button>
                    </div>
                `;
            } else {
                buttonContainer.innerHTML = `
                    <button class="add-btn" data-item-id="${itemId}" onclick="addToCart(${itemId}, '${itemName}', ${itemPrice})">ADD</button>
                `;
            }
        }

        // Function to increase quantity
        function increaseQuantity(itemId, itemName, itemPrice) {
            // Get existing cart or initialize empty object
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            
            if (cart[itemId]) {
                cart[itemId].quantity++;
                document.getElementById(`quantity-${itemId}`).innerText = cart[itemId].quantity;
                
                // Save to localStorage
                localStorage.setItem('cart', JSON.stringify(cart));
                
                // Update cart badge
                updateCartBadge();
                
                // Show notification
                showNotification(itemName);
            }
        }

        // Function to decrease quantity
        function decreaseQuantity(itemId, itemName, itemPrice) {
            // Get existing cart or initialize empty object
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            
            if (cart[itemId]) {
                cart[itemId].quantity--;
                
                if (cart[itemId].quantity <= 0) {
                    delete cart[itemId]; // Remove item if quantity is 0
                    
                    // Reset the button to ADD using updateButtonUI
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateButtonUI(itemId, itemName, itemPrice);
                } else {
                    document.getElementById(`quantity-${itemId}`).innerText = cart[itemId].quantity;
                    // Save to localStorage
                    localStorage.setItem('cart', JSON.stringify(cart));
                }
                
                // Update cart badge
                updateCartBadge();
            }
        }

        // Function to update cart badge
        function updateCartBadge() {
            const cartBadge = document.getElementById('cart-badge');
            
            // Get existing cart or initialize empty object
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            
            // Count total items in cart
            let totalItems = 0;
            for (const itemId in cart) {
                totalItems += cart[itemId].quantity;
            }
            
            // Update badge
            cartBadge.textContent = totalItems;
            
            if (totalItems > 0) {
                cartBadge.classList.add('show');
            } else {
                cartBadge.classList.remove('show');
            }
        }

        // Function to show notification
        function showNotification(itemName) {
            const notification = document.getElementById('notification');
            notification.textContent = `${itemName} added to cart!`;
            notification.classList.add('show');
            
            // Hide notification after 2 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        // Initialize UI when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Get existing cart or initialize empty object
            cart = JSON.parse(localStorage.getItem('cart')) || {};
            
            // Update UI for each item in cart
            for (const itemId in cart) {
                const item = cart[itemId];
                updateButtonUI(itemId, item.name, item.price);
            }
            
            // Update cart badge
            updateCartBadge();
        });
    </script>
</body>
</html>